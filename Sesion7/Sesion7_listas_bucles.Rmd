---
title: "SesiÃ³n 7 â€“ ExplicaciÃ³n detallada del bucle for para leer archivos"
output: html_document
---

# Â¿QuÃ© es una lista en R?

Una **lista** es una estructura versÃ¡til que puede almacenar diferentes tipos de objetos, incluyendo vectores, `data.frame`, strings, nÃºmeros e incluso otras listas.

```{r}
# Crear una lista simple
mi_lista <- list(
  nombre = "Ana",
  edad = 30,
  notas = c(8.5, 9.0, 10),
  aprobado = TRUE
)

mi_lista
```

## ğŸ¯ Acceso a elementos dentro de una lista

```{r}
# Acceso por nombre (con doble corchete)
mi_lista[["notas"]]

# Acceso por posiciÃ³n
mi_lista[[2]]

# Acceso por nombre usando el operador $
mi_lista$nombre
```

---

## ğŸ§¾ Almacenar `data.frames` dentro de una lista

Las listas tambiÃ©n permiten almacenar mÃºltiples tablas:

```{r}
lista_df <- list(mtcars, ToothGrowth)
```

---

# ğŸ” `apply()` â€“ Bucle vectorizado para matrices y `data.frames`

La funciÃ³n `apply()` permite aplicar una operaciÃ³n sobre las **filas** o **columnas** de un objeto tipo `matrix` o `data.frame`.

### ğŸ“š Sintaxis

```r
apply(X, MARGIN, FUN, ...)
```

- `X`: matriz o `data.frame`
- `MARGIN`: `1` para aplicar por filas, `2` para columnas
- `FUN`: la funciÃ³n que deseas aplicar (por ejemplo: `mean`, `sum`, `summary`, etc.)

---

## ğŸ§® Ejemplos prÃ¡cticos

### â• Calcular promedios por columna

```{r}
apply(mtcars, 2, mean)
```

### ğŸ“Š Obtener resumen estadÃ­stico por columna

```{r}
apply(mtcars, 2, summary)
```

---

## âŒ Alternativa manual (no recomendada)

```{r}
mean(mtcars$wt)
mean(mtcars$gear)
mean(mtcars$mpg)
```

âœï¸ Como puedes ver, hacerlo manualmente requiere muchas lÃ­neas.  
Con `apply()`, el mismo resultado se logra con una sola lÃ­nea, haciendo tu cÃ³digo mÃ¡s limpio y eficiente.

## lapply() â€“ bucle para listas
```{r}
# Devuelve una lista
my_list <-list("Lisa","Pedro","Alberto")
```
Contar numero de caracteres con funcion nchar par todos los elementos de la lista
```{r}
lapply(my_list, nchar)
```

De otra forma tendrÃ­a que realizarse la operaciÃ³n uno por uno
```{r}
nchar(my_list[[1]])
nchar(my_list[[2]])
nchar(my_list[[3]])
```

## ğŸ” Uso de bucle `for` para leer mÃºltiples archivos

En esta secciÃ³n explicaremos paso a paso cÃ³mo funciona el siguiente bloque de cÃ³digo. El objetivo es leer varios archivos `.csv` de forma automÃ¡tica y almacenarlos en una lista.

```r
# Crear lista vacÃ­a para almacenar resultados del bucle
df_list <- list()
# Almacenar archivos en vector filenames
filenames <- list.files()
for (ii in 1:10) {
  # Leer archivos con read.csv
  df_list[[ii]] <- read.csv(filenames[ii])
}

df_list
```

---

### ğŸ§  Â¿QuÃ© hace este cÃ³digo?

1. **`df_list <- list()`**

   - Se crea una lista vacÃ­a llamada `df_list`.
   - Esta lista servirÃ¡ como contenedor para guardar los resultados que obtengamos dentro del bucle.

---

2. **`for (ii in 1:10)`**

   - AquÃ­ se define un bucle que se ejecutarÃ¡ 10 veces.
   - La variable `ii` irÃ¡ tomando valores del 1 al 10 automÃ¡ticamente:
     - En la **primera vuelta**, `ii = 1`
     - En la **segunda vuelta**, `ii = 2`
     - ...
     - En la **dÃ©cima vuelta**, `ii = 10`
   - En cada vuelta, se ejecuta el bloque de cÃ³digo que estÃ¡ entre llaves `{}`.

---

3. **`read.csv(filenames[ii])`**

   - `filenames` es un vector que contiene los nombres de los archivos `.csv` que queremos leer.
   - En cada vuelta, `filenames[ii]` accede al archivo correspondiente segÃºn el valor de `ii`.
     - Por ejemplo, si `ii = 3`, se leerÃ¡ el archivo `filenames[3]`.
   - `read.csv()` carga ese archivo y lo convierte en un `data.frame`.

---

4. **`df_list[[ii]] <- ...`**

   - El resultado de `read.csv()` se guarda dentro de la lista `df_list` en la posiciÃ³n `ii`.
   - AsÃ­, el primer archivo va a `df_list[[1]]`, el segundo a `df_list[[2]]`, y asÃ­ sucesivamente.

---

### ğŸ“¦ Resultado final

DespuÃ©s de que el bucle termina:

- `df_list` contiene **10 objetos tipo `data.frame`**, uno por cada archivo leÃ­do.
- Puedes acceder a cada uno usando `df_list[[1]]`, `df_list[[2]]`, ..., `df_list[[10]]`.

---

### ğŸ¯ Â¿Por quÃ© es Ãºtil este patrÃ³n?

- Automatiza la lectura de mÃºltiples archivos sin repetir cÃ³digo.
- Organiza los resultados en una lista accesible.
- Es fÃ¡cil de adaptar para leer 5, 100 o mÃ¡s archivos cambiando el rango del bucle.

---

# ğŸ›  Crear mÃºltiples grÃ¡ficos con `for` loop

```{r}
library(ggplot2)
library(cowplot)

plot_list <- list()

for (ii in 1:ncol(mtcars)) {
  axis_titles <- colnames(mtcars[, c(1, ii)])
  my_df <- mtcars[, c(1, ii)]
  colnames(my_df) <- c("x_axis", "y_axis")

  plot_list[[ii]] <- ggplot(my_df, aes(x = x_axis, y = y_axis)) +
    geom_point() +
    xlab(axis_titles[1]) +
    ylab(axis_titles[2])
}

cowplot::plot_grid(plotlist = plot_list)
```

ğŸ¯ Este bucle:
- Toma cada columna del `mtcars` (salvo la primera).
- Crea un grÃ¡fico de dispersiÃ³n contra la primera variable (`mpg`).
- Almacena todos los grÃ¡ficos en una lista (`plot_list`).
- Finalmente los muestra todos juntos usando `plot_grid()`.

---

# ğŸ§  Â¿CuÃ¡ndo usar `apply`, `lapply`, `for`?

| Tipo     | Ideal para...                     | Devuelve         |
|----------|-----------------------------------|------------------|
| `for`    | Control total / pasos secuenciales| Nada (o manual)  |
| `apply`  | Operar sobre filas o columnas     | Vector / matriz  |
| `lapply` | Operar sobre listas               | Lista            |

---
